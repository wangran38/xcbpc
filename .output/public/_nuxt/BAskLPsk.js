import{c as M,s as I,m as V,b as _}from"./3EPULsr-.js";import{f as x,h as z}from"./tMw0Kily.js";import{_ as w,t as o,x as e,H as b,I as g,J as m,K as p,L as S,M as q,y as c,v as r,z as k,bG as v,g as P,bJ as E}from"./BZWdRYFE.js";const N={name:"Pagination",props:{currentPage:{type:Number,required:!0,default:1},pageSize:{type:Number,default:9},totalItems:{type:Number,required:!0,default:0},visiblePageCount:{type:Number,default:5},showJumper:{type:Boolean,default:!0},showInfo:{type:Boolean,default:!0}},data(){return{jumpPage:this.currentPage}},computed:{totalPages(){return this.totalItems<=0?1:Math.ceil(this.totalItems/this.pageSize)},visiblePages(){const i=[],t=this.totalPages,u=this.currentPage,d=this.visiblePageCount;if(t<=d){for(let h=1;h<=t;h++)i.push(h);return i}const n=Math.floor(d/2);let a=u-n,l=u+n;a<1&&(a=1,l=d),l>t&&(l=t,a=t-d+1);for(let h=a;h<=l;h++)i.push(h);return i}},watch:{currentPage(i){this.jumpPage=i}},methods:{handlePrev(){this.currentPage>1&&this.$emit("page-change",this.currentPage-1)},handleNext(){this.currentPage<this.totalPages&&this.$emit("page-change",this.currentPage+1)},handlePageChange(i){i!==this.currentPage&&this.$emit("page-change",i)},handleJump(){let i=this.jumpPage;isNaN(i)||i<1?i=1:i>this.totalPages&&(i=this.totalPages),this.jumpPage=i,i!==this.currentPage&&this.$emit("page-change",i)},getStartItem(){return this.totalItems===0?0:(this.currentPage-1)*this.pageSize+1},getEndItem(){if(this.totalItems===0)return 0;const i=this.currentPage*this.pageSize;return i>this.totalItems?this.totalItems:i}}},J={class:"pagination-container"},T={class:"pagination"},D=["disabled","aria-disabled"],F={class:"page-numbers"},B=["id","onClick"],U=["disabled","aria-disabled"],j={key:0,class:"page-jumper"},K=["max"],L={key:0,class:"pagination-info"};function O(i,t,u,d,n,a){return r(),o("div",J,[e("div",T,[e("button",{class:"pagination-btn prev-btn",onClick:t[0]||(t[0]=(...l)=>a.handlePrev&&a.handlePrev(...l)),disabled:u.currentPage===1,"aria-disabled":u.currentPage===1},t[6]||(t[6]=[e("i",{class:"icon","aria-hidden":"true"},"â†",-1),e("span",{class:"text"},"ä¸Šä¸€é¡µ",-1)]),8,D),e("div",F,[(r(!0),o(g,null,m(a.visiblePages,l=>(r(),o("button",{key:l,class:"page-btn",id:l==u.currentPage?"active":"",onClick:h=>a.handlePageChange(l)},c(l),9,B))),128))]),e("button",{class:"pagination-btn next-btn",onClick:t[1]||(t[1]=(...l)=>a.handleNext&&a.handleNext(...l)),disabled:u.currentPage===a.totalPages,"aria-disabled":u.currentPage===a.totalPages},t[7]||(t[7]=[e("span",{class:"text"},"ä¸‹ä¸€é¡µ",-1),e("i",{class:"icon","aria-hidden":"true"},"â†’",-1)]),8,U),u.showJumper?(r(),o("div",j,[t[8]||(t[8]=e("span",{class:"text"},"å‰å¾€",-1)),p(e("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=l=>n.jumpPage=l),class:"page-input",min:1,max:a.totalPages,onKeydown:t[3]||(t[3]=q((...l)=>a.handleJump&&a.handleJump(...l),["enter"])),onBlur:t[4]||(t[4]=(...l)=>a.handleJump&&a.handleJump(...l)),"aria-label":"è¾“å…¥é¡µç "},null,40,K),[[S,n.jumpPage,void 0,{number:!0}]]),t[9]||(t[9]=e("span",{class:"text"},"é¡µ",-1)),e("button",{class:"jump-btn",onClick:t[5]||(t[5]=(...l)=>a.handleJump&&a.handleJump(...l))},"ç¡®å®š")])):b("",!0)]),u.showInfo?(r(),o("div",L,[e("span",null,"æ˜¾ç¤º "+c(a.getStartItem())+"-"+c(a.getEndItem())+" é¡¹ï¼Œå…± "+c(u.totalItems)+" é¡¹",1)])):b("",!0)])}const A=w(N,[["render",O],["__scopeId","data-v-55c313fa"]]),G={data(){return{needLink:!0,selectFoodMarket:null,selectCounty:null,selecteEconomize:null,selecteMarket:2306,foodMarket:[],county:[],market:[],economize:[],query:{page:1,limit:9,isshow:1,title:null},totalnum:null,shops:[],timer:null,isShow:!1,elementTagOpacity:0,isInit:!0,keyValue:500}},components:{headerVue:z,footerVue:x,paginationVue:A},async mounted(){window.addEventListener("resize",()=>{window.innerWidth>840&&(this.isShow=!1,this.elementTagOpacity=0)}),this.initsSelectArea()},methods:{filterShops(i,t=!1,u=!0){return new Promise(async(d,n)=>{var a,l;try{switch(i){case 1:const h=await _({pid:this.selecteEconomize});h.code===200?(this.market=h.data||[],this.selecteMarket=this.market.length>0?this.market[0].id:null,u&&this.market.length>0?(d(),await this.filterShops(2,!1,!0)):d()):n(new Error("è·å–å¸‚çº§æ•°æ®å¤±è´¥"));break;case 2:const y=await _({pid:this.selecteMarket});y.code===200?(this.county=y.data||[],this.selectCounty=this.county.length>0?this.county[0].id:null,u&&this.county.length>0?(d(),await this.filterShops(3,!1,!0)):d()):n(new Error("è·å–å¿çº§æ•°æ®å¤±è´¥"));break;case 3:const s=await V({area_id:this.selectCounty,limit:100});s.code===200?(this.foodMarket=((a=s.data)==null?void 0:a.listdata)||[],this.selectFoodMarket=this.foodMarket.length>0?this.foodMarket[0].id:null,u&&this.foodMarket.length>0?(d(),await this.filterShops(4,!1,!0)):d()):n(new Error("è·å–èœå¸‚åœºæ•°æ®å¤±è´¥"));break;case 4:t&&(this.query.page=1),this.query.market_id=this.selectFoodMarket;const f=await I(this.query);this.shops=((l=f.data)==null?void 0:l.listdata)||[],this.totalnum=f.data.totalnum,d();break;default:d()}}catch(h){n(h)}})},async initSelect(){try{this.selecteEconomize=2291,await this.filterShops(1,!1,!1),this.selecteMarket=2306,await this.filterShops(2,!1,!1),this.selectCounty=2313,await this.filterShops(3,!1,!1),this.selectFoodMarket=23801,await this.filterShops(4)}catch(i){console.error("åˆå§‹åŒ–ç­›é€‰å¤±è´¥ï¼š",i)}},viewDetails(i){location.assign(`/storeDetails?id=${i.id}`)},switchIsshow(){this.isShow=!this.isShow,this.elementTagOpacity=this.isShow?1:0},inputTitle(){this.query.page=1,clearTimeout(this.timer),this.timer=setTimeout(()=>{this.filterShops(4)},300)},getPageData(i){this.query.page=i,this.filterShops(4)},async initsSelectArea(){let i=await M({level:1,limit:100});i.code==200&&(this.economize=i.data.listdata,this.initSelect())},goToShopDetail(i){this.$router.push(`/shops/${i}`)}}},H={class:"shops-page"},W={class:"filter-section"},Q={class:"container"},R={class:"filter-content"},X={class:"filter-options"},Y={class:"filter-group"},Z=["value"],$={class:"filter-group"},tt=["value"],et={class:"filter-group"},st=["value"],it={class:"filter-group"},at=["value"],nt={class:"search-box"},lt={class:"shops-list-section"},ot={class:"container"},rt={class:"shops-grid"},ut={class:"shop-image"},dt=["src","alt"],ht={class:"shop-info"},ct={class:"shop-name"},gt={class:"shop-location"},mt={class:"distance"},pt={class:"shop-tags"},ft={class:"shop-features"},yt={key:0,class:"feature-item"},vt={key:1,class:"feature-item"},kt={key:2,class:"feature-item"},Pt={class:"shop-actions"},bt=["onClick"],_t={key:0,class:"no-result"};function wt(i,t,u,d,n,a){const l=P("headerVue"),h=P("paginationVue"),y=P("footerVue");return r(),o("div",H,[k(l),t[21]||(t[21]=e("section",{class:"page-title-section"},[e("div",{class:"container"},[e("h2",null,"åˆä½œåº—é“ºå±•ç¤º"),e("p",null,"ç²¾é€‰ä¼˜è´¨å†œäº§å“å•†æˆ·ï¼Œæºå¤´ç›´ä¾›ï¼Œå“è´¨ä¿éšœ")])],-1)),e("section",W,[e("div",Q,[e("div",R,[e("div",X,[e("div",Y,[t[10]||(t[10]=e("label",null,"çœ:",-1)),p(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.selecteEconomize=s),onChange:t[1]||(t[1]=s=>a.filterShops(1))},[(r(!0),o(g,null,m(n.economize,s=>(r(),o("option",{value:s.id,key:s.id},c(s.name),9,Z))),128))],544),[[v,n.selecteEconomize]])]),e("div",$,[t[11]||(t[11]=e("label",null,"å¸‚:",-1)),p(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.selecteMarket=s),onChange:t[3]||(t[3]=s=>a.filterShops(2))},[(r(!0),o(g,null,m(n.market,s=>(r(),o("option",{value:s.id,key:s.id},c(s.name),9,tt))),128))],544),[[v,n.selecteMarket]])]),e("div",et,[t[12]||(t[12]=e("label",null,"å¿/åŒº:",-1)),p(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.selectCounty=s),onChange:t[5]||(t[5]=s=>a.filterShops(3))},[(r(!0),o(g,null,m(n.county,s=>(r(),o("option",{value:s.id,key:s.id},c(s.name),9,st))),128))],544),[[v,n.selectCounty]])]),e("div",it,[t[13]||(t[13]=e("label",null,"èœå¸‚åœº:",-1)),p(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>n.selectFoodMarket=s),onChange:t[7]||(t[7]=s=>{a.filterShops(4,!0)})},[(r(!0),o(g,null,m(n.foodMarket,s=>(r(),o("option",{value:s.id,key:s.id},c(s.marketname),9,at))),128))],544),[[v,n.selectFoodMarket]])])]),e("div",nt,[p(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=s=>n.query.title=s),placeholder:"æœç´¢åº—é“º",onInput:t[9]||(t[9]=(...s)=>a.inputTitle&&a.inputTitle(...s))},null,544),[[S,n.query.title]]),t[14]||(t[14]=e("button",{class:"search-btn"},"ğŸ”",-1))])])])]),e("section",lt,[e("div",ot,[e("div",rt,[(r(!0),o(g,null,m(n.shops,s=>(r(),o("div",{class:"shop-card",key:s.id},[e("div",ut,[e("img",{src:s.logo,alt:s.name},null,8,dt),e("div",{class:E(["shop-badge",s.type])},c(s.category_name),3),t[15]||(t[15]=e("div",{class:"shop-rating"},[e("span",{class:"star"},"â˜…"),e("span",{class:"score"},c(111))],-1))]),e("div",ht,[e("h3",ct,c(s.title),1),e("div",gt,[t[16]||(t[16]=e("i",{class:"location-icon"},null,-1)),e("span",null,c(s.market_address),1),e("span",mt,c(s.distance),1)]),e("div",pt,[(r(!0),o(g,null,m(s.tags,(f,C)=>(r(),o("span",{class:"tag",key:C},c(f),1))),128))]),e("div",ft,[(r(),o("div",yt,t[17]||(t[17]=[e("i",{class:"online-icon"},null,-1),e("span",null,"æ”¯æŒçº¿ä¸Šä¸‹å•",-1)]))),(r(),o("div",vt,t[18]||(t[18]=[e("i",{class:"delivery-icon"},null,-1),e("span",null,"æ»¡é¢å…é…é€è´¹",-1)]))),(r(),o("div",kt,t[19]||(t[19]=[e("i",{class:"promo-icon"},null,-1),e("span",null,"æœ‰ä¼˜æƒ æ´»åŠ¨",-1)])))])]),e("div",Pt,[e("button",{class:"enter-btn",onClick:f=>a.viewDetails(s)},"æŸ¥çœ‹åº—é“º",8,bt)])]))),128))]),n.shops.length===0?(r(),o("div",_t,t[20]||(t[20]=[e("p",null,"æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„åº—é“ºï¼Œè¯·å°è¯•å…¶ä»–ç­›é€‰æ¡ä»¶",-1)]))):b("",!0),k(h,{currentPage:n.query.page,pageSize:n.query.limit,totalItems:n.totalnum,onPageChange:a.getPageData},null,8,["currentPage","pageSize","totalItems","onPageChange"])])]),k(y)])}const It=w(G,[["render",wt]]);export{It as default};
